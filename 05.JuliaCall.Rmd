---
jupyter:
  jupytext:
    formats: ipynb,Rmd
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.1'
      jupytext_version: 1.2.1
  kernelspec:
    display_name: R
    language: R
    name: ir
---

```{r}
diffeqr::diffeq_setup()
```

```{r}
f <- function (du,u,p,t) {
      resid1 = - 0.04*u[1]              + 1e4*u[2]*u[3] - du[1]
      resid2 = + 0.04*u[1] - 3e7*u[2]^2 - 1e4*u[2]*u[3] - du[2]
      resid3 = u[1] + u[2] + u[3] - 1.0
      c(resid1,resid2,resid3)
    }

u0 = c(1.0, 0, 0)
du0 = c(-0.04, 0.04, 0.0)
tspan = list(0.0,100000.0)
differential_vars = c(TRUE,TRUE,FALSE)
sol = diffeqr::dae.solve(f,du0,u0,tspan,differential_vars=differential_vars)
udf = as.data.frame(sol$u)
```

```{r}
matplot(sol$t,udf,"l",col=1:3)
```

```{r}

```
